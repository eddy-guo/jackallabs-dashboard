---
import Layout from "../layouts/Layout.astro";

// Jackal Validator Addresses
const secretAddress = "secretvalcons1qz6dgmf0rgk8p08wznlnmqe7hnm4qydftvaajj",
evmosAddress = "evmos1fpjf8aywxg9qxexfwu9lanlgw58f5fhqyj79xt",
akashAddress = "akash1mryswr20mxltwhlqulsk0hnscmmxw32tad7yxx",
kujiraAddress = "kujira1uf9knclap4a0vrqn8dj726anyhst7l02nymu3j";

// Secret Info
const secretLatestBlock = await fetch("https://api.scrt.network/blocks/latest").then((res) => res.json()),
secretCurrBlock = parseInt(secretLatestBlock["block"]["header"]["height"]),
secretValidators = await fetch(`https://api.scrt.network/validatorsets/${secretCurrBlock-30}`).then((res) => res.json()),
secretMaxValidators = secretValidators["result"]["validators"].length;
var jackalSecretRank;

// find rank by iterating through all validators
for (let i = 0; i < secretValidators["result"]["validators"].length; i++) {
  if (secretValidators["result"]["validators"][i]["address"] == secretAddress) {
    jackalSecretRank = i + 1;
  }
}
---

<Layout title="Jackal Labs Dashboard">
  <main>
    <div class="secret">
      <b>Secret</b>
      <div class="block-height">Current Block Height: {secretCurrBlock}</div>
      <div class="max-validators">
        Number of Validators: {secretMaxValidators}
      </div>
      <div class="rank">Rank: {jackalSecretRank}</div>
    </div>
  </main>
</Layout>

<style>
  main {
    font-size: 30px;
    justify-content: center;
    text-align: center;
  }

  .rank {
    padding-bottom: 10px;
  }
</style>
